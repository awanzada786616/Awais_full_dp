(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2295:(e,t,r)=>{"use strict";r.d(t,{FullscreenDPForm:()=>R});var a=r(5155),s=r(2115),n=r(4624),l=r(2085),i=r(2596),o=r(9688);function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,i.$)(t))}let c=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:i=!1,...o}=e,u=i?n.DX:"button";return(0,a.jsx)(u,{className:d(c({variant:s,size:l,className:r})),ref:t,...o})});u.displayName="Button";let m=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});m.displayName="Input";var f=r(968);let h=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(f.b,{ref:t,className:d(h(),r),...s})});x.displayName=f.b.displayName;let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});p.displayName="Card",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("flex flex-col space-y-1.5 p-6",r),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",r),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let g=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("p-6 pt-0",r),...s})});g.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:d("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter";var b=r(9104);let v=s.forwardRef((e,t)=>{let{className:r,value:s,...n}=e;return(0,a.jsx)(b.bL,{ref:t,className:d("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...n,children:(0,a.jsx)(b.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});v.displayName=b.bL.displayName;var N=r(9420),j=r(4416),w=r(9869),y=r(1154),S=r(5339),k=r(437),P=r(4357),C=r(5196),E=r(6766);let A=["Waiting for pairing code","Establishing WhatsApp connection","Syncing WhatsApp data","Processing image","Setting profile picture","Finalizing process"];function R(){let[e,t]=(0,s.useState)(""),[r,n]=(0,s.useState)(null),[l,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(!1),[c,f]=(0,s.useState)(!1),[h,b]=(0,s.useState)(""),[R,D]=(0,s.useState)(-1),[F,_]=(0,s.useState)(0),[z,I]=(0,s.useState)("Initializing..."),[L,T]=(0,s.useState)(null),[O,W]=(0,s.useState)(!1),[U,M]=(0,s.useState)(null),[B,G]=(0,s.useState)(null),[q,H]=(0,s.useState)(!1),[J,V]=(0,s.useState)(!1),X=(0,s.useRef)(null),Q=(0,s.useRef)(null),$=(0,s.useRef)(null),K=(0,s.useRef)(null),Y=e=>{e&&e.type.startsWith("image/")?(n(e),i(URL.createObjectURL(e)),T(null)):T("Please select a valid image file")},Z=()=>{n(null),i(null),X.current&&(X.current.value="")},ee=async e=>{try{await navigator.clipboard.writeText(e),V(!0),setTimeout(()=>V(!1),2e3)}catch(r){let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),V(!0),setTimeout(()=>V(!1),2e3)}catch(e){console.error("Failed to copy text: ",e)}document.body.removeChild(t)}},et=()=>{requestAnimationFrame(()=>{K.current&&K.current.scrollIntoView({behavior:"smooth",block:"start"})})},er=e=>{Q.current&&Q.current.close(),console.log("Starting SSE connection for session:",e);let t=new EventSource("/api/fullscreendp/status?session_id=".concat(e));Q.current=t,t.onopen=()=>{console.log("SSE connection opened")},t.onmessage=e=>{console.log("SSE message received:",e.data);try{let t=JSON.parse(e.data);ea(t)}catch(t){console.error("Error parsing SSE data:",t,"Raw data:",e.data)}},t.onerror=e=>{console.error("SSE error:",e),console.log("SSE readyState:",t.readyState),t.readyState===EventSource.CLOSED&&(console.log("SSE connection closed"),T("Connection lost. Please try again."),d(!1))}},ea=e=>{console.log("Handling SSE update:",e);let{status:t,message:r,step:a,totalSteps:s,userInfo:n,error:l}=e;if("error"===t||"timeout"===t){T(l||r||"An error occurred"),d(!1);return}if("completed"===t){W(!0),I(r),_(100),D(A.length),n&&M(n),d(!1);return}void 0!==a&&void 0!==s&&(_((a+1)/s*100),D(a)),r&&I(r)},es=async t=>{if(t.preventDefault(),!e.trim()||!r){T("Please fill in all fields");return}let a="fullscreen_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));G(a),d(!0),f(!0),T(null),W(!1),M(null),b(""),_(0),D(-1),I("Initializing..."),V(!1);try{console.log("Starting process with session ID:",a),er(a);let t=new FormData;t.append("profile-file",r),t.append("phone_number",e),t.append("session_id",a),console.log("Sending form data to API...");let s=await fetch("/api/fullscreendp",{method:"POST",body:t}),n=await s.json();if(console.log("API response:",n),n.success)b(n.code),I("Pairing code generated! Enter it in WhatsApp."),_(20);else throw Error(n.error||"Failed to start process")}catch(e){console.error("Error:",e),T(e instanceof Error?e.message:"An error occurred"),d(!1)}};return(0,s.useEffect)(()=>{if(c&&K.current){let e=setTimeout(()=>{et()},300);return()=>clearTimeout(e)}},[c]),(0,s.useEffect)(()=>()=>{Q.current&&Q.current.close(),l&&URL.revokeObjectURL(l)},[l]),(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,a.jsx)(p,{className:"border border-neutral-800 bg-black transition-all duration-300 hover:border-neutral-700",children:(0,a.jsx)(g,{className:"p-6 sm:p-8",children:(0,a.jsxs)("form",{onSubmit:es,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2 animate-in slide-in-from-left duration-300 delay-100",children:[(0,a.jsx)(x,{htmlFor:"phone",className:"text-sm font-medium text-white",children:"Phone Number"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(N.A,{className:"absolute left-3 top-3 h-4 w-4 text-neutral-400 transition-colors duration-200"}),(0,a.jsx)(m,{id:"phone",type:"text",placeholder:"919876543210",value:e,onChange:e=>t(e.target.value),className:"pl-10 bg-black border-neutral-800 text-white placeholder:text-neutral-500 focus:border-neutral-600 transition-all duration-200 focus:ring-1 focus:ring-neutral-600",required:!0,disabled:o})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 font-light",children:"Include country code, no + sign"})]}),(0,a.jsxs)("div",{className:"space-y-2 animate-in slide-in-from-left duration-300 delay-200",children:[(0,a.jsx)(x,{htmlFor:"file",className:"text-sm font-medium text-white",children:"Profile Picture"}),(0,a.jsxs)("div",{ref:$,onDragOver:e=>{e.preventDefault(),H(!0)},onDragLeave:e=>{e.preventDefault(),H(!1)},onDrop:e=>{e.preventDefault(),H(!1);let t=e.dataTransfer.files;t.length>0&&Y(t[0])},className:"relative border-2 border-dashed rounded-lg p-6 transition-all duration-300 cursor-pointer ".concat(q?"border-white bg-neutral-900":r?"border-neutral-600 bg-neutral-950":"border-neutral-800 hover:border-neutral-600 hover:bg-neutral-950"),onClick:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)("input",{ref:X,type:"file",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&Y(r)},className:"hidden",disabled:o}),r?(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg overflow-hidden border border-neutral-700 flex-shrink-0",children:l&&(0,a.jsx)(E.default,{src:l||"/placeholder.svg",alt:"Preview",width:40,height:40,className:"object-cover"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white text-sm font-medium",children:r.name}),(0,a.jsxs)("p",{className:"text-neutral-400 text-xs",children:[(r.size/1024/1024).toFixed(2)," MB"]})]})]}),(0,a.jsx)(u,{type:"button",variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),Z()},className:"text-neutral-400 hover:text-white hover:bg-neutral-800 transition-colors duration-200",children:(0,a.jsx)(j.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(w.A,{className:"mx-auto h-8 w-8 text-neutral-400 mb-2"}),(0,a.jsx)("p",{className:"text-white text-sm font-medium mb-1",children:q?"Drop your image here":"Click to upload or drag and drop"}),(0,a.jsx)("p",{className:"text-neutral-400 text-xs font-light",children:"PNG, JPG, GIF up to 10MB"})]})]})]}),l&&(0,a.jsx)("div",{className:"flex justify-center animate-in zoom-in duration-300 delay-300",children:(0,a.jsx)("div",{className:"relative w-32 h-32 sm:w-40 sm:h-40 rounded-lg overflow-hidden border border-neutral-800 shadow-lg",children:(0,a.jsx)(E.default,{src:l||"/placeholder.svg",alt:"Preview",fill:!0,className:"object-cover"})})}),(0,a.jsx)(u,{type:"submit",className:"w-full bg-white text-black hover:bg-neutral-100 transition-all duration-200 font-medium animate-in slide-in-from-bottom duration-300 delay-400",disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Start Process"})]})})}),c&&(0,a.jsx)(p,{ref:K,className:"border border-neutral-800 bg-black animate-in slide-in-from-bottom duration-500",children:(0,a.jsxs)(g,{className:"p-6 sm:p-8 space-y-6",children:[L&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-neutral-900 border border-neutral-700 rounded-lg animate-in slide-in-from-top duration-300",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 text-neutral-300 mt-0.5 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-neutral-200 text-sm font-light",children:L})]}),h&&(0,a.jsxs)("div",{className:"text-center space-y-4 animate-in zoom-in duration-500",children:[(0,a.jsx)("p",{className:"text-white font-medium",children:"Enter this pairing code in WhatsApp:"}),(0,a.jsxs)("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-4 sm:p-6 transition-all duration-300 hover:border-neutral-700 cursor-pointer group relative",onClick:()=>ee(h),children:[(0,a.jsx)("div",{className:"text-xl sm:text-2xl font-mono text-white tracking-wider",children:h}),(0,a.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:J?(0,a.jsx)(k.A,{className:"h-4 w-4 text-green-400"}):(0,a.jsx)(P.A,{className:"h-4 w-4 text-neutral-400"})}),J&&(0,a.jsx)("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-neutral-800 text-white text-xs px-2 py-1 rounded animate-in fade-in duration-200",children:"Copied!"})]}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-neutral-400 leading-relaxed font-light",children:"WhatsApp → Settings → Linked Devices → Link a Device → Link with Phone Number Instead"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 font-light",children:"Tap the code above to copy"})]}),(0,a.jsxs)("div",{className:"space-y-2 animate-in slide-in-from-left duration-300",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-white font-medium",children:"Progress"}),(0,a.jsxs)("span",{className:"text-neutral-400 font-light",children:[Math.round(F),"%"]})]}),(0,a.jsx)(v,{value:F,className:"bg-neutral-900 h-1"})]}),(0,a.jsx)("p",{className:"text-neutral-300 font-light animate-in fade-in duration-300",children:z}),(0,a.jsx)("div",{className:"space-y-3",children:A.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 transition-all duration-300 animate-in slide-in-from-left delay-".concat(50*t),children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:t<R||O&&R>=A.length?(0,a.jsx)("div",{className:"w-5 h-5 rounded-full bg-white flex items-center justify-center transition-all duration-300",children:(0,a.jsx)(C.A,{className:"h-3 w-3 text-black"})}):t!==R||O?(0,a.jsx)("div",{className:"w-5 h-5 rounded-full border border-neutral-700 transition-all duration-300"}):(0,a.jsx)("div",{className:"w-5 h-5 rounded-full bg-white animate-pulse transition-all duration-300"})}),(0,a.jsx)("span",{className:"text-sm font-light transition-all duration-300 ".concat(t<R||O&&R>=A.length?"text-white":t!==R||O?"text-neutral-500":"text-white"),children:e})]},t))}),O&&U&&(0,a.jsx)(p,{className:"border border-neutral-800 bg-neutral-950 animate-in zoom-in duration-500",children:(0,a.jsxs)(g,{className:"p-4 sm:p-6",children:[(0,a.jsxs)("h3",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-white"}),"Process Completed Successfully"]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-neutral-400 font-light",children:"Phone:"}),(0,a.jsx)("span",{className:"text-white font-mono",children:U.phone})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-neutral-400 font-light",children:"Name:"}),(0,a.jsx)("span",{className:"text-white font-light",children:U.name})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-neutral-400 font-light",children:"Total Users:"}),(0,a.jsx)("span",{className:"text-white font-light",children:U.totalUsers})]})]})]})}),(O||L)&&(0,a.jsx)(u,{onClick:()=>{d(!1),f(!1),T(null),W(!1),t(""),n(null),i(null),b(""),M(null),D(-1),_(0),V(!1),X.current&&(X.current.value=""),Q.current&&(Q.current.close(),Q.current=null)},className:"w-full bg-white text-black hover:bg-neutral-100 transition-all duration-200 font-medium animate-in slide-in-from-bottom duration-300",children:"Start New Process"})]})})]})}},9036:(e,t,r)=>{Promise.resolve().then(r.bind(r,2295)),Promise.resolve().then(r.t.bind(r,6874,23)),Promise.resolve().then(r.t.bind(r,3063,23))}},e=>{var t=t=>e(e.s=t);e.O(0,[673,441,684,358],()=>t(9036)),_N_E=e.O()}]);